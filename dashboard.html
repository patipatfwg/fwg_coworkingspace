<link rel="stylesheet" href="css/fwgDashboard.css">
<style>
  #Floor29{
    background-image: url("images/fl29.jpg");
    background-position: center;
    background-repeat: no-repeat;
    background-size: cover;
    width: 1200px;
    height: 660px;
  }
</style>
<!-- <div class="row">
  <div class="col-md-12 grid-margin stretch-card">
    <div class="card">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-end flex-wrap">
          <button type="button" class="btn btn-light bg-white btn-icon mr-3 d-none d-md-block ">
            <i class="mdi mdi-download text-muted"></i>
          </button>
          <button type="button" class="btn btn-light bg-white btn-icon mr-3 mt-2 mt-xl-0">
            <i class="mdi mdi-clock-outline text-muted"></i>
          </button>
          <button type="button" id="OnCreate" class="btn btn-light bg-white btn-icon mr-3 mt-2 mt-xl-0">
            <i class="mdi mdi-plus text-muted"></i>
          </button>
          <button class="btn btn-primary mt-2 mt-xl-0">Generate report</button>
        </div>
      </div>
    </div>
  </div>
</div> -->

<div class="row">
  <div class="col-md-12 grid-margin">
    <div class="d-flex justify-content-between flex-wrap">
      <!-- <div class="d-flex align-items-end flex-wrap"> -->
        <div class="col-lg-12">
          <div class="input-group">
            <div class="input-group-prepend">
              <a href="#" style="text-decoration: none;">
              <span class="input-group-text font-weight-bold bg-warning text-white mdi mdi-chevron-left"></span>
              </a>
            </div>
            <input type="text" class="form-control text-center font-weight-bold" id="titleDatetime" disabled>
            <div class="input-group-append">
              <a href="#" style="text-decoration: none;">
              <span class="input-group-text font-weight-bold bg-warning text-white mdi mdi-chevron-right"></span>
              </a>
            </div>
          </div>
        </div>
      <!-- </div> -->
    </div>
  </div>
</div>
<div class="row">
  <div class="col-md-12 grid-margin stretch-card">
    <div class="card">
      <div class="card-body" id="Floor29">

          <div class="row SeatZone SeatZoneA">
            <div class="col">
              <div id="A1" class="SeatAvailable"  >A1</div>
            </div>
          </div>

          <div class="row SeatZone SeatZoneB">
            <div class="col">
              <div id="myCanvas" class="SeatAvailable"  >B1</div>
            </div>
          </div>

          <div class="row SeatZone SeatZoneC">
            <div class="col">
              <div id="myCanvas" class="SeatAvailable"  >C1</div>
            </div>
          </div>

      </div>
    </div>
  </div>
</div>
<div class="row">
  <div id="msgbox"></div>
</div>
<div class="row">
  <div class="card">
    <div class="form-group">
      Booking
    </div>
    <div class="form-group">
      <input type="text" class="form-control form-control-lg " id="InputDatetimeStart">
    </div>
    <div class="form-group">
      <input type="text" class="form-control form-control-lg " id="InputDatetimeEnd" >
    </div>
    <div class="form-group">
      <input type="text" class="form-control form-control-lg " id="InputZone" value="A" >
    </div>
    <div class="form-group">
      <input type="text" class="form-control form-control-lg " id="InputSeat" value="A16" >
    </div>
    <div class="form-group">
      <button type="button" class="btn btn-primary" id="Add">Booking</button>
    </div>
  </div>
</div>
<div class="row">
  <div class="card">
    <div class="form-group">
      <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">Open Modal</button>
    </div>
  </div>
</div>

<!-- Modal -->
<div class="modal fade" id="myModal" role="dialog">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <div class="modal-body">
        <p>This is a small modal.</p>
      </div>
    </div>
  </div>
</div>

<script src="js/jquery.js" type="text/javascript"></script>
<script language="javascript">

  $(document).ready(function(){

    Display();

    $("#titleDatetime").val( FWGDate(1) );

    $("#InputDatetimeStart").val(FWGDate(2));

    $("#InputDatetimeEnd").val(FWGDate(2));    

    // $("#onCreate").click(function(){
    //   $("#main-panel").load("create.html");
    // });

    $("#A1").click(function(){
      Popover("#A1");
    });

    $("#Add").click(function(){
      callCreate();
    });

    $("#TestSquare").click(function(){
      callShowSeat();
    });

  });

  const driver = new Driver({ opacity: 0 });

  function FWGDate(sw)
  {
    // var d = new Date().toLocaleDateString();
    var dt = new Date();
    var time = dt.getHours() + ":" + dt.getMinutes();

    if(sw==1)
    {
      var dayArr= ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
      dt.setDate(dt.getDate());
      var monthArr = ["January", "February","March", "April", "May", "June", "July", "August", "September", "October", "November","December"];
      var date = dayArr[dt.getDay()].toUpperCase() +", "+ dt.getDate() +" "+ monthArr[dt.getMonth()].toUpperCase() +" "+ dt.getFullYear();      
    }
    else if(sw==2)
    {
      var month = (dt.getMonth()+1);
      var date = dt.getFullYear()+"-"+month+"-"+dt.getDate()+" "+time;
    }
    return date;
  }

  function Popover(seat)
  {
    driver.highlight({
        element: seat,
        popover: {
          title: 'Patipat Chanrungruang',
          description: 'Booking: 19:30 - 20:00',
          position: 'top',
        }
    });
  }

  /*
  function Rectangle()
  {
    var elem = document.getElementById('draw-group');
    var two = new Two({ width: 50, height: 50 }).appendTo(elem);

    // var circle = two.makeCircle(-70, 0, 50);
    var rect = two.makeRectangle(70, 0, 100, 100);
    // circle.fill = '#FF8000';
    // circle.stroke = 'orangered';
    rect.fill = 'rgba(0, 200, 255, 0.75)';
    rect.stroke = '#1C75BC';

    // Groups can take an array of shapes and/or groups.
    var group = two.makeGroup(rect);

    // And have translation, rotation, scale like all shapes.
    group.translation.set(two.width / 2, two.height / 2);
    group.rotation = Math.PI;
    group.scale = 0.75;

    // You can also set the same properties a shape have.
    group.linewidth = 7;

    two.update();
  }
  */

  function Display()
  {
    var request = $.ajax({
      method: "POST",url: "api/read.php",
      data: { action:"dashboard" }
    });
    request.fail(function (jqXHR, textStatus) {
      //504
      // $("#msgbox").html("Please Check Internet");
      alert("Please Check Internet");
    });
    request.done(function(msg) {
      var code = msg.code;
      if(code==200)
      {
        $("#msgbox").html(msg);
      }
    }); 
  }

  function callCreate(booking_employee_start,booking_employee_end)
  {
    var request = $.ajax({
      method: "POST",url: "api/create.php",
      data: { 
        action : "add",
        user_id : localStorage.getItem("user_id"),
        booking_employee_start : $("#InputDatetimeStart").val(),
        booking_employee_end : $("#InputDatetimeEnd").val(),
        booking_type_id : 1,
        booking_room_id : 0,
        booking_zone_id : $("#InputZone").val(),
        booking_seat_id : $("#InputSeat").val()
      }
    });
    request.fail(function (jqXHR, textStatus) {
      //504
      $("#msgbox").html("Please Check Internet");
    });
    request.done(function(msg) {
      var code = msg.code;
      if(code==200)
      {
        // $("#msgbox").html(msg);
        alert(msg);
      }
      else
      {
        // $("#msgbox").html(msg);
        alert(msg);
      }
    });      
  }

  function callShowSeat()
  {
    var request = $.ajax({
      method: "POST",url: "api/read.php",
      data: { action:"showseat" }
    });
    request.fail(function (jqXHR, textStatus) {
      //504
      $("#msgbox").html("Please Check Internet");
    });
    request.done(function(msg) {
      var code = msg.code;
      if(code==200)
      {
        $("#msgbox").html(msg.first_name_en);
      }
    });
  }

</script>